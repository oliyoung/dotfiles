# Minimal Zsh Configuration
# Migrated from Oh My Zsh - see .zshrc.bak for previous config

# ============================================================================
# HISTORY
# ============================================================================
export HISTFILE="$HOME/.zsh_history"
export HISTSIZE=1000000000
export SAVEHIST=$HISTSIZE

setopt EXTENDED_HISTORY       # Timestamps in history
setopt HIST_IGNORE_ALL_DUPS   # No duplicates
setopt HIST_IGNORE_SPACE      # Don't record commands starting with space
setopt SHARE_HISTORY          # Share history between sessions

# ============================================================================
# SHELL OPTIONS
# ============================================================================
setopt autocd                 # cd by just typing directory name
setopt interactive_comments   # Allow comments in interactive shell

# ============================================================================
# COMPLETION
# ============================================================================
autoload -Uz compinit
compinit

# ============================================================================
# KEYBINDINGS
# ============================================================================
# Emacs keybindings (default)
bindkey -e

# ============================================================================
# FZF - Fuzzy Finder Integration
# ============================================================================
if command -v fzf &> /dev/null; then
    # Try Ubuntu/Debian path first
    if [ -f /usr/share/doc/fzf/examples/key-bindings.zsh ]; then
        source /usr/share/doc/fzf/examples/key-bindings.zsh
    else
        # Fall back to fzf --zsh (works with most installations)
        eval "$(fzf --zsh 2>/dev/null)" || true
    fi
fi

# ============================================================================
# TERMINAL & THEME
# ============================================================================
# Directory colors - bright cyan (uses custom dircolors configuration)
if [ -f ~/.dircolors ]; then
    eval "$(dircolors ~/.dircolors)"
fi

# Starship prompt - modern shell prompt
if command -v starship &> /dev/null; then
    eval "$(starship init zsh)"
fi

# ============================================================================
# ENVIRONMENT VARIABLES
# ============================================================================
# WSL2 DISPLAY for X11 forwarding
export DISPLAY=$(cat /etc/resolv.conf | grep nameserver | awk '{print $2; exit;}'):0.0

# Editor
export EDITOR=vim

# Puppeteer
export PUPPETEER_EXECUTABLE_PATH=/home/oliy/.cache/puppeteer/chrome-headless-shell/linux-143.0.7499.169/chrome-headless-shell-linux64/chrome-headless-shell

# ============================================================================
# ALIASES
# ============================================================================
# Colors for common commands
alias ls='ls --color=auto'
alias grep='grep --color=auto'
alias fgrep='fgrep --color=auto'
alias egrep='egrep --color=auto'

# ls shortcuts
alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'

# ============================================================================
# TOOLS & INTEGRATIONS
# ============================================================================
# rbenv - Ruby version manager
if command -v rbenv &> /dev/null; then
    eval "$(rbenv init - --no-rehash zsh)"
fi

# Local environment
[ -f "$HOME/.local/bin/env" ] && . "$HOME/.local/bin/env"
