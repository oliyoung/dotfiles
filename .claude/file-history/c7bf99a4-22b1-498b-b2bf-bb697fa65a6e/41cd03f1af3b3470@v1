{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://api.otr.com.au/events/CustomerEnrolledInLoyalty.schema.json",
  "title": "CustomerEnrolledInLoyalty Event",
  "description": "Event published by LoyaltyService when a customer is enrolled in the loyalty program (EagleEye wallet created). Published in response to CustomerProfileCreated event.",
  "type": "object",
  "properties": {
    "specversion": {
      "type": "string",
      "const": "1.0",
      "description": "CloudEvents specification version."
    },
    "type": {
      "type": "string",
      "const": "com.otr.loyalty.CustomerEnrolledInLoyalty",
      "description": "Type of event."
    },
    "source": {
      "type": "string",
      "const": "/loyalty-service",
      "description": "Context in which the event happened."
    },
    "id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique event identifier."
    },
    "time": {
      "type": "string",
      "format": "date-time",
      "description": "Timestamp of event creation."
    },
    "datacontenttype": {
      "type": "string",
      "const": "application/json"
    },
    "data": {
      "type": "object",
      "description": "The custom event data payload.",
      "properties": {
        "vivaConsumerId": {
          "type": "string",
          "pattern": "^vci_[a-zA-Z0-9]+$",
          "description": "The customer's Viva Consumer ID."
        },
        "walletId": {
          "type": "string",
          "description": "The EagleEye wallet identifier created for this customer."
        },
        "enrolledAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the customer was enrolled in the loyalty program."
        }
      },
      "required": ["vivaConsumerId", "walletId", "enrolledAt"],
      "additionalProperties": false
    }
  },
  "required": ["specversion", "type", "source", "id", "time", "datacontenttype", "data"],
  "additionalProperties": false
}
