     1→= ProductCatalog Bounded Context
     2→O.Young@otr.com.au
     3→v0.1, 2025-01-13
     4→:project-name: OTRG Apps & Ecommerce Architecture
     5→:togaf-adm-phase: Phase C: Information Systems Architectures
     6→:document-type: Bounded Context
     7→:status: Draft
     8→:version: 0.1
     9→:domain: Product
    10→:bounded-context-type: APPLICATION
    11→:domain-architect: O.Young@otr.com.au
    12→:doctype: article
    13→:toc: left
    14→:toclevels: 4
    15→:sectanchors:
    16→:sectlinks:
    17→:sectnums:
    18→:icons: font
    19→:source-highlighter: highlightjs
    20→:experimental:
    21→:description: Bounded Context for the Product Domain - Product catalog and pricing facade
    22→:keywords: product, catalog, pricing, bounded context, togaf, ddd, facade, acl
    23→
    24→Product catalog and pricing facade service that translates D365 Commerce product and pricing data into AWS-native APIs for customer-facing applications and external integrations.
    25→
    26→This service acts as an Anti-Corruption Layer (ACL) between back-office systems (Azure) and ecommerce domain (AWS), providing a stable, domain-aligned API contract for digital menu boards, mobile apps, and ecommerce platforms.
    27→
    28→== Business Context
    29→
    30→The `ProductCatalogService` is a facade and translation layer that bridges OTR's back-office product and pricing systems (D365 Commerce on Azure) with customer-facing digital experiences (AWS).
    31→
    32→It enables external systems (Amped Digital DMB, OTR Mobile App, SMGB Online) to consume product catalog and pricing data through a standardised REST API without coupling to D365's domain model or Azure infrastructure.
    33→
    34→Initial use case: Subway Digital Menu Board pricing integration with Amped Digital vendor.
    35→
    36→== Architectural Pattern
    37→
    38→The `ProductCatalogService` acts as a **Facade and Anti-Corruption Layer**, NOT a system of record.
    39→
    40→It protects the ecommerce domain from D365 Commerce's data model and provides a stable API contract in OTR's ubiquitous language, enabling back-office systems to evolve independently.
    41→
    42→=== Key Characteristics
    43→
    44→* **Facade Layer:** Simplifies access to complex back-office pricing data
    45→* **Anti-Corruption Layer:** Translates D365 terminology into domain language
    46→* **Caching Layer:** Stores pricing data locally for fast query performance
    47→* **Event Publisher:** Publishes domain events when pricing changes (future-proofing)
    48→
    49→== Strategic Value
    50→
    51→=== Vendor Independence
    52→
    53→* ACL pattern protects ecommerce domain from D365 Commerce data model changes
    54→* D365 can be replaced with alternative ERP/product systems without rewriting consumers
    55→* Single translation layer shields digital experiences from back-office migrations
    56→
    57→=== Platform Consistency
    58→
    59→* All customer-facing pricing APIs hosted on AWS (ecommerce team's platform)
    60→* Consistent with OTR Mobile App, SMGB Online, and digital experiences architecture
    61→* Leverages existing AWS expertise, tooling, and operational processes
    62→
    63→=== Operational Efficiency
    64→
    65→* Single API serves multiple consumers (DMB, mobile, web, future integrations)
    66→* Reduces point-to-point integrations between D365 and customer-facing systems
    67→* Centralised caching reduces load on D365 Commerce API
    68→
    69→=== Future Extensibility
    70→
    71→* Event-driven integration enables reactive pricing updates across ecosystem
    72→* Foundation for advanced features: price testing, dynamic pricing, promotional rules
    73→* Scalable pattern for additional product catalog capabilities (inventory, categories)
    74→
    75→== Long-Term Vision
    76→
    77→The ProductCatalogService is a **Supporting Domain** microservice that forms part of OTRG's ecommerce platform:
    78→
    79→* **Cross-cloud integration pattern:** Clean data contract between Azure (back-office) and AWS (ecommerce)
    80→* **Multi-brand support:** Single service supports OTR, Subway, SMGB, and future brands
    81→* **API-first design:** RESTful API with OpenAPI specification for external vendors
    82→* **Event-driven future:** Enables real-time price change notifications to mobile apps, DMBs, and web platforms
    83→* **2026 roadmap capabilities:** Dynamic pricing, A/B price testing, promotional pricing engine integration
    84→
    85→== Future State Benefits
    86→
    87→* **Vendor independence:** Swap D365 Commerce for alternative product/pricing systems without domain changes
    88→* **Single pricing API** for all customer-facing channels (DMB, mobile, web, kiosks)
    89→* **Advanced features:** Real-time price updates via events, promotional pricing integration, inventory visibility
    90→* **Unified product catalog** across all OTR brands and channels
    91→* **Scalable architecture:** Supporting 2026 Digital Roadmap growth and multi-brand expansion
    92→
    93→== Aggregates
    94→
    95→[width="100%",cols="15%,85%",options="header",]
    96→|===
    97→|Aggregate Name |Description
    98→
    99→|`ProductPrice`
   100→|Cached representation of product pricing from D365 Commerce. Contains product details (ID, name, category), price groups, regional pricing, and store assignments. Updated hourly via ETL pipeline. **Not** a system of record - D365 Commerce owns authoritative pricing data.
   101→
   102→|===
   103→
   104→=== Aggregate: ProductPrice
   105→
   106→The `ProductPrice` aggregate represents a cached view of pricing data for external API consumption.
   107→
   108→*Aggregate Root:* `ProductPrice`
   109→
   110→*Entities:*
   111→
   112→* `Product` - Product identifier, name, category
   113→* `Price` - Price amount, price group, effective dates
   114→* `PriceGroup` - Price group identifier, region code, store assignments
   115→
   116→*Invariants:*
   117→
   118→* Price amount must be greater than zero
   119→* Each product must have at least one price group
   120→* Effective date ranges cannot overlap for the same product/price group combination
   121→* Store IDs must exist in the store master data
   122→
   123→*Lifecycle:*
   124→
   125→. Created/updated via hourly ETL pipeline from D365 Commerce export
   126→. Validated against data contract schema
   127→. Stored in RDS PostgreSQL for fast query access
   128→. Queried via REST API by external consumers
   129→. Refreshed hourly - data is eventually consistent (max 1 hour lag)
   130→
   131→== Services
   132→
   133→[width="100%",cols="25%,75%",options="header",]
   134→|===
   135→|Service Name |Description
   136→
   137→|`PricingQueryService`
   138→|Query pricing data by product ID, store ID, or price group. Returns pricing in API response format for external consumers.
   139→
   140→|`ProductCatalogETLService`
   141→|ETL service that ingests D365 Commerce pricing exports from S3, validates data contract compliance, and loads into RDS PostgreSQL.
   142→
   143→|`DataValidationService`
   144→|Validates incoming pricing data against schema and business rules. Alerts on validation failures.
   145→
   146→|`D365PricingTranslator`
   147→|Anti-Corruption Layer that translates D365 Commerce terminology and data structures into ProductCatalog domain language.
   148→
   149→|`CacheInvalidationService`
   150→|Manages API Gateway cache invalidation when new pricing data is loaded (future enhancement: ElastiCache integration).

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
