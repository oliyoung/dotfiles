     1→:Canonical: Transaction
     2→:Domain Architect: O.Young@otr.com.au
     3→:Version: 0.1.0
     4→:Domain: Transaction
     5→:doctype: article
     6→:toc: left
     7→:toclevels: 5
     8→:sectanchors:
     9→:sectlinks:
    10→:sectnums:
    11→:icons: font
    12→:source-highlighter: highlightjs
    13→:experimental:
    14→
    15→== Domain Vision
    16→
    17→Manage customer transactions across all channels (in-store, fuel, mobile app, web) with complete transaction and payment details.
    18→
    19→== What is the Transaction Domain?
    20→
    21→The Transaction Domain captures what customers buy - the complete record of each purchase including items, quantities, prices, discounts, payments, and receipts. It's the "shopping cart" and "order history" for OTR.
    22→
    23→== Domain Structure
    24→
    25→=== Core Subdomains
    26→
    27→==== Transaction Processing
    28→
    29→===== Purpose
    30→
    31→Process customer transactions, manage transactions, calculate totals, and coordinate payment.
    32→
    33→===== Plain English
    34→
    35→This is the checkout flow:
    36→
    37→*Transaction Flow:*
    38→
    39→. Customer adds items to transaction
    40→. System calculates totals (subtotal, tax, discounts, final total)
    41→. Customer selects payment method
    42→. System validates rewards eligibility (calls LoyaltyService)
    43→. Customer confirms purchase
    44→. Payment processed (calls PaymentService)
    45→. Rewards finalized (calls LoyaltyService)
    46→. Receipt generated
    47→. Transaction recorded
    48→
    49→*Transaction Types:*
    50→
    51→- *Fuel transactions*: Pump fuel, calculate amount based on volume/price
    52→- *Retail transactions*: Scan items, calculate totals
    53→- *Mixed transactions*: Fuel + retail in single transaction
    54→- *Mobile app orders*: Pre-order for pickup/delivery
    55→- *Web orders*: Online shopping for delivery
    56→
    57→*Calculation Logic:*
    58→
    59→- Apply product-level discounts (sale prices)
    60→- Apply transaction-level promotions (spend $50, get $5 off)
    61→- Calculate tax (GST in Australia)
    62→- Apply loyalty discounts/grants
    63→- Calculate final total
    64→
    65→This is core because the specific transaction types, pricing rules, and discount logic reflect OTR's business model.
    66→
    67→==== Transaction Management
    68→
    69→===== Purpose
    70→
    71→Track line items, quantities, prices, and promotions within customer transactions.
    72→
    73→===== Plain English
    74→
    75→This is the shopping cart:
    76→
    77→*Transaction Contents:*
    78→
    79→- Line items (each product in transaction)
    80→  * Product SKU
    81→  * Product name
    82→  * Quantity
    83→  * Unit price
    84→  * Line total
    85→  * Discounts applied
    86→  * Promotions applied
    87→
    88→*Transaction Operations:*
    89→
    90→- Add item to transaction
    91→- Remove item from transaction
    92→- Update quantity
    93→- Apply promotion code
    94→- Clear transaction
    95→
    96→*Transaction Rules:*
    97→
    98→- Minimum purchase requirements
    99→- Maximum quantities (purchase limits)
   100→- Product restrictions (age-restricted items)

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
